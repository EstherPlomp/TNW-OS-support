<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Esther Plomp">
<meta name="dcterms.date" content="2022-11-29">

<title>FAQ – TNW-OS-support</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">TNW-OS-support</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EstherPlomp/TNW-OS-support"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">FAQ</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Open Science</div>
                <div class="quarto-category">TU Delft</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Esther Plomp </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 29, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This page contains 11 frequently asked questions (FAQ) regarding Open Science:</p>
<section id="is-this-something-that-is-taken-into-account-when-looking-for-a-next-job" class="level3">
<h3 class="anchored" data-anchor-id="is-this-something-that-is-taken-into-account-when-looking-for-a-next-job"><strong>1. Is this something that is taken into account when looking for a next job?</strong></h3>
<ul>
<li><p>Read the publication: ‘<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0850-7">five selfish reasons to work reproducible</a>’ or watch the presentation.</p></li>
<li><p>Some of the vacancies have listed open science requirements, see here for an overview: ‘<a href="https://osf.io/7jbnt/">Academic job offers that mentioned open science</a>’</p></li>
<li><p>Funders are asking about this! See for example: <a href="https://www.nwo.nl/en/open-science">NWO</a></p></li>
<li><p>Preprints receive more citations for their eventually published papers! See <a href="https://doi.org/10.7554/eLife.52646">Fu and Hughey 2019</a>; <a href="https://doi.org/10.1162/qss_a_00043">Fraser et al.&nbsp;2020</a>; <a href="https://doi.org/10.1101/2020.04.02.022079">Sarabipour et al.&nbsp;2020</a></p></li>
<li><p>Papers with open data also receive more citations: <a href="http://doi.org/10.1371/journal.pone.0000308">Piwowar et al.&nbsp;2007</a>; <a href="http://doi.org/10.7717/peerj.175">Piowar and Vision 2014;</a> <a href="https://doi.org/10.1371/journal.pone.0230416">Colavizza et al.&nbsp;2020</a></p></li>
</ul>
</section>
<section id="what-does-the-tu-delft-facilitate" class="level3">
<h3 class="anchored" data-anchor-id="what-does-the-tu-delft-facilitate"><strong>2. What does the TU Delft facilitate?</strong></h3>
<ul>
<li><p>There’s a <a href="https://osc-delft.github.io/">TU Delft Open Science Community</a></p></li>
<li><p>There’s a Data Steward at your faculty - Esther (<a href="mailto:e.plomp@tudelft.nl">e.plomp@tudelft.nl</a>)</p></li>
<li><p>There’s a data repository which you can use to share your data/code: <a href="https://data.4tu.nl/info/en/">4TU.ResearchData</a></p></li>
<li><p>There are some MOOCs and courses you can take,</p>
<ul>
<li><p><a href="https://www.tudelft.nl/library/research-data-management/r/training-evenementen/training-voor-onderzoekers/research-data-management-101">Research Data Management 101</a></p></li>
<li><p><a href="https://intranet.tudelft.nl/-/open-life-science-programme">Open Life Science</a> (for any TNW discipline, not just Life Sciences)</p></li>
<li><p><a href="https://www.tudelft.nl/en/library/research-data-management/r/training-events/training-for-researchers/software-carpentry-workshop">Software Carpentry</a> and <a href="https://www.tudelft.nl/en/library/research-data-management/r/training-events/training-for-researchers/coderefinery-workshops">Code Refinery</a> Workshops (programming workshops)</p></li>
<li><p><a href="https://online-learning.tudelft.nl/courses/open-science-sharing-your-research-with-the-world/">TU Delft Open Science MOOC</a></p></li>
</ul></li>
</ul>
</section>
<section id="what-are-the-open-science-regulations-from-the-tu" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-open-science-regulations-from-the-tu"><strong>3. What are the open science regulations from the TU?</strong></h3>
<ul>
<li><p>PhDs that started from the 1st of Jan 2019 will need to share the code/data underlying their articles/thesis through a data repository and PhDs that started from the 1st of Jan 2020 will have to <a href="https://estherplomp.github.io/TNW-OS-support/posts/DMP-PhD/">set up a Data Management Plan</a>.</p>
<ul>
<li><p>You can find the TNW policy here: <a href="https://d2k0ddhflgrk1i.cloudfront.net/Library/Themaportalen/RDM/Beleid/2020_AS_Research_Data_Management_Policy.pdf" class="uri">https://d2k0ddhflgrk1i.cloudfront.net/Library/Themaportalen/RDM/Beleid/2020_AS_Research_Data_Management_Policy.pdf</a>&nbsp;</p></li>
<li><p>And the TU Delft policy here: <a href="https://doi.org/10.5281/zenodo.2573159" class="uri">https://doi.org/10.5281/zenodo.2573159</a> (on Zenodo, another data repository!)</p></li>
</ul></li>
<li><p>Since 2016 it is mandatory for TU Delft researchers to make their work available through direct open access.</p>
<ul>
<li><p>See the The TU Delft <a href="https://d1rkab7tlqy5f1.cloudfront.net/Library/Themaportalen/Open.tudelft.nl/OA_beleid.pdf">Open Access policy</a>&nbsp;</p></li>
<li><p>Through <a href="https://www.tudelft.nl/en/library/library-for-researchers/library-for-researchers/publishing-outreach/you-share-we-take-care">‘You Share, We Take Care’ project</a> the publishers version can be shared after a 6 month embargo period</p></li>
</ul></li>
<li><p>There’s a <a href="https://doi.org/10.5281/zenodo.4629662">TU Delft Resesearch Software Policy</a>. You can make your code available through <a href="https://data.4tu.nl/info/en/">4TU.ResearchData</a> using one of the licenses that TU Delft approves (Apache, MIT, BSD, EUPL, LGPL, GPL, CC0).&nbsp;</p></li>
</ul>
</section>
<section id="who-cares-about-what-you-put-online" class="level3">
<h3 class="anchored" data-anchor-id="who-cares-about-what-you-put-online"><strong>4. Who cares about what you put online?</strong></h3>
<ul>
<li><p>Researchers in your discipline that would like to verify or reuse the work</p></li>
<li><p>You in six months. In case anyone is asking about your outputs you can always provide them with a link to them, and it won’t cost you a lot of work at that point because you already have it out there!&nbsp;</p></li>
<li><p>TU Delft: Whenever possible, data/code should be made available in a repository (see the <a href="https://doi.org/10.5281/zenodo.2573159">TU Delft Research Data policy</a>)</p></li>
<li><p>Journals. Some journals require you to make the code/data/methods available. You should always check the requirements of the journal before you submit. Usually there will be a section in the authors guidelines!</p></li>
<li><p>Funders. <a href="https://estherplomp.github.io/TNW-OS-support/posts/data-sharing-2021/">Funding agencies have requirements.</a> Funders want public money being spend in ways that it benefits the public that is funding the research!</p></li>
</ul>
</section>
<section id="up-to-what-degree-do-you-want-to-put-data-online" class="level3">
<h3 class="anchored" data-anchor-id="up-to-what-degree-do-you-want-to-put-data-online"><strong>5. Up to what degree do you want to put data online?</strong></h3>
<ul>
<li><p>The minimal requirements are the data underlying the publication, so the processed data. If it is useful to share the raw data it is encouraged.</p></li>
<li><p>Try to share data in a reusable and/or open format. For example, you can share an excel sheet, but not everyone will have access to Microsoft products, so it is also helpful to share a .csv file of that excel sheet so that everyone can access it.&nbsp;</p></li>
</ul>
</section>
<section id="where-do-i-put-my-datacode" class="level3">
<h3 class="anchored" data-anchor-id="where-do-i-put-my-datacode"><strong>6. Where do I put my data/code?</strong></h3>
<ul>
<li><p>You can archive/publish your data (or code) using a data journal if the dataset is extensive enough. Examples are <a href="https://www.nature.com/sdata/">Scientific Data</a> and <a href="https://www.journals.elsevier.com/data-in-brief">Data in brief</a> for data.&nbsp;</p></li>
<li><p>You can also publish your code through a publication format using, for example, <a href="https://www.journals.elsevier.com/softwarex/">SoftwareX</a>, <a href="https://www.journals.elsevier.com/software-impacts/">Software Impacts</a> and the <a href="https://joss.theoj.org/">Journal of Open Source Software</a> (no subscription fees or publishing costs for this one!)</p></li>
<li><p>If you want to publish data that is underlying a ‘regular’ paper you can always use a data repository such as <a href="https://data.4tu.nl/info/en/">4TU.ResearchData</a> or <a href="https://zenodo.org/">Zenodo</a>. You can also see if you can find a more disciplinary specific repository by using keywords of your research topic through <a href="https://fairsharing.org/">FAIRsharing.org</a>. They have an overview of the data repositories. There may not be a very specific archive that you can use to share your data. In that case 4TU.ResearchData/Zenodo are always good options!</p></li>
</ul>
</section>
<section id="what-do-you-do-when-the-processed-data-is-actually-wrong" class="level3">
<h3 class="anchored" data-anchor-id="what-do-you-do-when-the-processed-data-is-actually-wrong"><strong>7. What do you do when the processed data is actually wrong?</strong></h3>
<ul>
<li><p>You cannot remove the data once you have published/shared them publicly, but you are able to upload a new version. You can then explain in the README file that there was a mistake in the data and that the current version is the correct version!</p></li>
<li><p>Correcting and updating your data will increase trust in you as a researcher (<a href="https://doi.org/10.1371/journal.pbio.1002460">Ebersole et al.&nbsp;2016</a>)</p></li>
</ul>
</section>
<section id="is-it-better-to-put-unpolished-code-online-or-nothing" class="level3">
<h3 class="anchored" data-anchor-id="is-it-better-to-put-unpolished-code-online-or-nothing"><strong>8. Is it better to put unpolished code online or nothing?</strong></h3>
<ul>
<li><p>Having your code well documented and polished will be more useful, but to at least have access to the working script would be better than to not be able to verify your results at all.</p></li>
<li><p>You can accelerate scientific discovery through sharing your code so that others can re-use it, or you can establish collaborations if others are interested in using your code. You can also increase your visibility/impact when others find your code and reuse it.</p></li>
</ul>
</section>
<section id="what-if-my-code-gets-misused" class="level3">
<h3 class="anchored" data-anchor-id="what-if-my-code-gets-misused"><strong>9. What if my code gets misused?</strong></h3>
<ul>
<li>You can apply the Apache license to your code that holds a ‘Accepting Warranty or Additional Liability’ clause (<a href="https://ant.apache.org/license.html">point 9 here</a>) in it that states that the person using/sharing your code with adaptations is taking full responsibility for any liabilities.&nbsp;</li>
</ul>
</section>
<section id="how-should-we-be-licensing-our-data-and-code" class="level3">
<h3 class="anchored" data-anchor-id="how-should-we-be-licensing-our-data-and-code"><strong>10. How should we be licensing our data and code?</strong></h3>
<ul>
<li><p>TU Delft recommends CC-BY, but it is up to you how you want to license your data. CC-BY is recommended because it allows for the broadest reuse of your data. With each restriction you place on datasets (no commercial use or modification), you complicate the reuse of your data.&nbsp;</p>
<ul>
<li><p>See the <a href="https://creativecommons.org/licenses/">Creative Commons Website</a> for an overview of the licenses</p></li>
<li><p>Creative Commons are also setting up a <a href="https://creativecommons.org/choose/">license selector</a>!</p></li>
</ul></li>
<li><p>For software you can share your code under: Apache, MIT, BSD, EUPL, LGPL, GPL, CC0. Other licenses are also possible, but should be discussed with the Innovation Center. See the <a href="https://choosealicense.com/">Choose a Licence website</a> for an overview.</p></li>
<li><p>For articles TU Delft does not have a specific licence requirement, but NWO and the European Commission ask to apply the CC-BY licenses to articles.</p></li>
</ul>
</section>
<section id="how-do-we-manage-and-share-lab-notes" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-manage-and-share-lab-notes"><strong>11. How do we manage and share lab notes?</strong></h3>
<ul>
<li><p>Make sure you have a digital copy of your lab book somewhere: you can lose your written lab books (or your house/lab can burn down and you will lose all of this info). You can:</p>
<ul>
<li><p>Scan your written notes and save these as pdf files</p></li>
<li><p>Write your notes up digitally. This allows you to structure this data better.</p></li>
<li><p>Use an Electronic Lab Notebook. <a href="https://www.tudelft.nl/en/library/research-data-management/r/manage/electronic-lab-notebook">TU Delft offers licenses</a> for <a href="https://www.elabjournal.com/">eLABjournal</a> and <a href="https://www.researchspace.com/">RSpace</a>. Especially RSpace can make it easier to publicly share the data as it has integrations with data repositories.</p></li>
</ul></li>
</ul>
</section>
<section id="more-information" class="level2">
<h2 class="anchored" data-anchor-id="more-information">More information</h2>
<ul>
<li><a href="https://www.tudelft.nl/library/research-data-management/r/buttons/faqs">TU Delft Research Data Management FAQ</a></li>
<li>Appendix A in <a href="https://doi.org/10.5281/zenodo.7320029">Karoune and Plomp 2022</a> (page 20)</li>
<li>email Esther</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/EstherPlomp\.github\.io\/TNW-OS-support\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>